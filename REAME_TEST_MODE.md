# ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π –†–µ–∂–∏–º –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω!

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–î–æ–±–∞–≤–ª–µ–Ω **—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º** –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã `unified_worker.py` –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è 6 —á–∞—Å–æ–≤.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º:
```bash
python toggle_test_mode.py on
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å worker:
```bash
python unified_worker.py
```

### –ù–∞–±–ª—é–¥–∞—Ç—å:
–ö–∞–∂–¥—ã–µ **10 —Å–µ–∫—É–Ω–¥** –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è —Ü–∏–∫–ª –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤!

### –í—ã–∫–ª—é—á–∏—Ç—å:
```bash
python toggle_test_mode.py off
```

---

## üìä –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã

| –ó–∞–¥–∞—á–∞ | –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º | –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º |
|--------|---------------|----------------|
| –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–∏–¥–µ–æ | 6 —á–∞—Å–æ–≤ | **10 —Å–µ–∫—É–Ω–¥** ‚ö° |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π | 1 —á–∞—Å | **30 —Å–µ–∫—É–Ω–¥** |
| –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ | 1 –º–∏–Ω—É—Ç–∞ | **10 —Å–µ–∫—É–Ω–¥** |

---

## üëÄ –ß—Ç–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ

```
============================================================
STARTING UNIFIED WORKER
============================================================
‚ö†Ô∏è  TEST MODE ENABLED - Short intervals for testing!
‚ö†Ô∏è  Set TEST_MODE=false in .env for production use
  - Process metrics: every 10 seconds (TEST MODE)
  - Update schedules: every 30 seconds (TEST MODE)
  - Fetch videos: every 10 seconds (TEST MODE)
Scheduler started
Running initial tasks...
Starting fetch_new_videos task (Run #1)
‚ö†Ô∏è  TEST MODE - Using reduced delays!
Found 1 accounts in database
Processing account: username (id=12345)
Job completed: processed 1 accounts

WORKER IS RUNNING
Press Ctrl+C to stop

# ‚Üì‚Üì‚Üì –ß–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ ‚Üì‚Üì‚Üì

Starting fetch_new_videos task (Run #2)
‚ö†Ô∏è  TEST MODE - Using reduced delays!
...

# ‚Üì‚Üì‚Üì –ß–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ ‚Üì‚Üì‚Üì

Starting fetch_new_videos task (Run #3)
...
```

**–°—á—ë—Ç—á–∏–∫ –∑–∞–ø—É—Å–∫–æ–≤** `(Run #1, #2, #3...)` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Ü–∏–∫–ª —Ä–∞–±–æ—Ç–∞–µ—Ç! üéØ

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **unified_worker.py** (–æ–±–Ω–æ–≤–ª—ë–Ω)
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `TEST_MODE`
   - –°—á—ë—Ç—á–∏–∫–∏ –∑–∞–ø—É—Å–∫–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏
   - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏

2. **.env.example** (–æ–±–Ω–æ–≤–ª—ë–Ω)
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `TEST_MODE=false`

3. **toggle_test_mode.py** ‚≠ê
   - –£–¥–æ–±–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
   - –†–∞–±–æ—Ç–∞–µ—Ç –≤ Windows —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π UTF-8

4. **TEST_MODE.md**
   - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–æ–≤–æ–º—É —Ä–µ–∂–∏–º—É
   - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

5. **TEST_MODE_QUICKSTART.txt**
   - –ë—ã—Å—Ç—Ä–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞
   - –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
   - –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

---

## üéÆ –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º
python toggle_test_mode.py

# –í–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
python toggle_test_mode.py on

# –í—ã–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
python toggle_test_mode.py off

# –ó–∞–ø—É—Å—Ç–∏—Ç—å worker –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
python toggle_test_mode.py on && python unified_worker.py

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ 30 —Å–µ–∫—É–Ω–¥ –∏ –≤—ã–∫–ª—é—á–∏—Ç—å
timeout 30 python unified_worker.py && python toggle_test_mode.py off
```

---

## ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º **–¢–û–õ–¨–ö–û** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
- ‚ö†Ô∏è –û—á–µ–Ω—å —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ Instagram
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
- ‚ö†Ô∏è –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

**–í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ –æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º** –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è! üîÑ

---

## ‚úÖ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ü–∏–∫–ª —Ä–∞–±–æ—Ç–∞–µ—Ç

### –®–∞–≥ 1: –í–∫–ª—é—á–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
```bash
python toggle_test_mode.py on
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ worker
```bash
python unified_worker.py
```

### –®–∞–≥ 3: –ù–∞–±–ª—é–¥–∞–π—Ç–µ 1 –º–∏–Ω—É—Ç—É
–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
- `Starting fetch_new_videos task (Run #1)` - —Å—Ä–∞–∑—É
- `Starting fetch_new_videos task (Run #2)` - —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
- `Starting fetch_new_videos task (Run #3)` - —á–µ—Ä–µ–∑ 20 —Å–µ–∫—É–Ω–¥
- `Starting fetch_new_videos task (Run #4)` - —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥
- `Starting fetch_new_videos task (Run #5)` - —á–µ—Ä–µ–∑ 40 —Å–µ–∫—É–Ω–¥
- `Starting fetch_new_videos task (Run #6)` - —á–µ—Ä–µ–∑ 50 —Å–µ–∫—É–Ω–¥
- `Starting fetch_new_videos task (Run #7)` - —á–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥

### –®–∞–≥ 4: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ (Ctrl+C)
```
Press Ctrl+C to stop
^C
Shutting down...
Worker stopped
```

### –®–∞–≥ 5: –í—ã–∫–ª—é—á–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
```bash
python toggle_test_mode.py off
```

---

## üéØ –¢–∏–ø–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
python toggle_test_mode.py

# 2. –í–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
python toggle_test_mode.py on

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å worker
python unified_worker.py

# 4. –ù–∞–±–ª—é–¥–∞—Ç—å 1-2 –º–∏–Ω—É—Ç—ã
# (—É–≤–∏–¥–µ—Ç—å 6-12 –∑–∞–ø—É—Å–∫–æ–≤ —Å —Å—á—ë—Ç—á–∏–∫–æ–º Run #1, #2, #3...)

# 5. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (Ctrl+C)

# 6. –í—ã–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
python toggle_test_mode.py off

# 7. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ
python unified_worker.py
```

---

## üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### unified_worker.py
```python
# –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç os
import os

# –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—á—ë—Ç—á–∏–∫–∏ –≤ __init__
self.fetch_count = 0
self.schedule_count = 0
self.metrics_count = 0

# –ü—Ä–æ–≤–µ—Ä–∫–∞ TEST_MODE –≤ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–µ
test_mode = os.getenv('TEST_MODE', 'false').lower() == 'true'

# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
if test_mode:
    videos_interval = 10  # 10 —Å–µ–∫—É–Ω–¥
else:
    videos_interval = settings.worker_interval_hours * 3600  # —á–∞—Å—ã

# –í—ã–≤–æ–¥ —Å –Ω–æ–º–µ—Ä–æ–º –∑–∞–ø—É—Å–∫–∞
logger.info(f"Starting fetch_new_videos task (Run #{self.fetch_count})")
```

---

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:
- ‚úÖ –ë—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É worker –∑–∞ 1 –º–∏–Ω—É—Ç—É –≤–º–µ—Å—Ç–æ 6 —á–∞—Å–æ–≤
- ‚úÖ –í–∏–¥–µ—Ç—å —Å—á—ë—Ç—á–∏–∫–∏ –∑–∞–ø—É—Å–∫–æ–≤ `(Run #1, #2, #3...)`
- ‚úÖ –õ–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏
- ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ü–∏–∫–ª —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–£–¥–∞—á–∏ —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º!** üöÄ
