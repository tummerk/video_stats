╔════════════════════════════════════════════════════════════════════╗
║              ТЕСТОВЫЙ РЕЖИМ - БЫСТРЫЙ СТАРТ                       ║
╚════════════════════════════════════════════════════════════════════╝

┌─ БЫСТРОЕ ВКЛЮЧЕНИЕ ───────────────────────────────────────────────┐
│                                                                    │
│  Вариант 1: Скрипт (рекомендуется)                                 │
│    python toggle_test_mode.py on                                   │
│                                                                    │
│  Вариант 2: Ручной                                                │
│    echo "TEST_MODE=true" >> .env                                   │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘

┌─ ЗАПУСК WORKER В ТЕСТОВОМ РЕЖИМЕ ─────────────────────────────────┐
│                                                                    │
│  python unified_worker.py                                          │
│                                                                    │
│  Вы увидите:                                                       │
│    ⚠️  TEST MODE ENABLED - Short intervals for testing!           │
│    ⚠️  Set TEST_MODE=false in .env for production use             │
│    - Process metrics: every 10 seconds (TEST MODE)                │
│    - Update schedules: every 30 seconds (TEST MODE)                │
│    - Fetch videos: every 10 seconds (TEST MODE)                    │
│                                                                    │
│  Каждые 10 секунд будет появляться:                                │
│    Starting fetch_new_videos task (Run #1)                         │
│    Starting fetch_new_videos task (Run #2)                         │
│    Starting fetch_new_videos task (Run #3)                         │
│    ...                                                              │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘

┌─ ВЫКЛЮЧЕНИЕ ТЕСТОВОГО РЕЖИМА ────────────────────────────────────┐
│                                                                    │
│  Вариант 1: Скрипт                                                 │
│    python toggle_test_mode.py off                                  │
│                                                                    │
│  Вариант 2: Ручной                                                │
│    # Отредактируйте .env:                                          │
│    TEST_MODE=false                                                 │
│    # или удалите строку полностью                                  │
│                                                                    │
│  Вариант 3: Изменить в .env                                        │
│    sed -i 's/TEST_MODE=true/TEST_MODE=false/' .env                │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘

┌─ ПРОВЕРКА ТЕКУЩЕГО РЕЖИМА ─────────────────────────────────────────┐
│                                                                    │
│  python toggle_test_mode.py                                        │
│                                                                    │
│  Или:                                                              │
│    grep TEST_MODE .env                                             │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘

┌─ СРАВНЕНИЕ ИНТЕРВАЛОВ ────────────────────────────────────────────┐
│                                                                    │
│  Задача                    │ Обычный режим │ Тестовый режим       │
│  ──────────────────────────┼──────────────┼────────────────────   │
│  Fetch videos              │ 6 часов      │ 10 секунд             │
│  Update schedules          │ 1 час        │ 30 секунд             │
│  Process metrics           │ 1 минута     │ 10 секунд             │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘

┌─ ПРИМЕР ВЫВОДА В ТЕСТОВОМ РЕЖИМЕ ─────────────────────────────────┐
│                                                                    │
│  ============================================================       │
│  STARTING UNIFIED WORKER                                           │
│  ============================================================       │
│  ⚠️  TEST MODE ENABLED - Short intervals for testing!             │
│  ⚠️  Set TEST_MODE=false in .env for production use                │
│    - Process metrics: every 10 seconds (TEST MODE)                 │
│    - Update schedules: every 30 seconds (TEST MODE)                │
│    - Fetch videos: every 10 seconds (TEST MODE)                    │
│  Scheduler started                                                 │
│  Running initial tasks...                                          │
│  Starting fetch_new_videos task (Run #1)                           │
│  ⚠️  TEST MODE - Using reduced delays!                             │
│  Found 1 accounts in database                                      │
│  Processing account: username (id=12345)                           │
│  Job completed: processed 1 accounts                               │
│  Checking for videos needing schedule updates (Run #1)...          │
│  Processing scheduled metrics collection (Run #1)...               │
│  WORKER IS RUNNING                                                 │
│  Press Ctrl+C to stop                                              │
│                                                                    │
│  # Через 10 секунд:                                                │
│  Starting fetch_new_videos task (Run #2)                           │
│  ⚠️  TEST MODE - Using reduced delays!                             │
│  ...                                                                │
│                                                                    │
│  # Через 10 секунд:                                                │
│  Starting fetch_new_videos task (Run #3)                           │
│  ...                                                                │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘

┌─ СЧЁТЧИКИ ЗАПУСКОВ ───────────────────────────────────────────────┐
│                                                                    │
│  В тестовом режиме видно номера запусков:                          │
│                                                                    │
│  • Starting fetch_new_videos task (Run #1)                         │
│  • Checking for videos needing schedule updates (Run #1)           │
│  • Processing scheduled metrics collection (Run #1)                │
│                                                                    │
│  Это помогает убедиться, что цикл работает!                        │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘

┌─ ПРЕДОСТЕРЕЖЕНИЯ ─────────────────────────────────────────────────┐
│                                                                    │
│  ⚠️  Тестовый режим ТОЛЬКО для тестирования!                       │
│                                                                    │
│  НЕ используйте для:                                              │
│    • Продакшена                                                    │
│    • Длительной работы                                             │
│    • Аккаунтов с большим количеством видео                          │
│                                                                    │
│  Причина:                                                          │
│    • Очень частые запросы к Instagram API                          │
│    • Может вызвать rate limiting или блокировку                    │
│    • Нагрузка на базу данных                                       │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘

┌─ ПОЛЕЗНЫЕ КОМАНДЫ ─────────────────────────────────────────────────┐
│                                                                    │
│  # Проверить статус:                                               │
│    python toggle_test_mode.py                                      │
│                                                                    │
│  # Включить тестовый режим:                                        │
│    python toggle_test_mode.py on                                   │
│                                                                    │
│  # Выключить тестовый режим:                                       │
│    python toggle_test_mode.py off                                  │
│                                                                    │
│  # Запустить на 30 секунд в тестовом режиме:                      │
│    python toggle_test_mode.py on && timeout 30 python unified_worker.py && python toggle_test_mode.py off  │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘

┌─ ТИПИЧНЫЙ СЦЕНАРИЙ ТЕСТИРОВАНИЯ ──────────────────────────────────┐
│                                                                    │
│  1. Включить тестовый режим:                                       │
│     python toggle_test_mode.py on                                  │
│                                                                    │
│  2. Запустить worker:                                              │
│     python unified_worker.py                                       │
│                                                                    │
│  3. Наблюдать за циклами в течение 1-2 минут                       │
│     (увидеть 6-12 запусков fetch_new_videos)                       │
│                                                                    │
│  4. Убедиться, что:                                                │
│     ✓ Счётчики запусков увеличиваются (Run #1, #2, #3...)         │
│     ✓ Нет ошибок                                                   │
│     ✓ Аккаунты обрабатываются                                      │
│                                                                    │
│  5. Остановить (Ctrl+C)                                            │
│                                                                    │
│  6. Выключить тестовый режим:                                      │
│     python toggle_test_mode.py off                                 │
│                                                                    │
│  7. Запустить в обычном режиме:                                    │
│     python unified_worker.py                                       │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘

╔════════════════════════════════════════════════════════════════════╗
║  Документация: TEST_MODE.md для подробной информации              ║
╚════════════════════════════════════════════════════════════════════╝
