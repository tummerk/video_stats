# –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç: –î–µ–ø–ª–æ–π Instagram Reels Tracker

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

–ü–æ–ª–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∫ Docker –¥–µ–ø–ª–æ—é –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å–æ–≥–ª–∞—Å–Ω–æ –ø–ª–∞–Ω—É.

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (6 —Ñ–∞–π–ª–æ–≤)
1. **Dockerfile.admin** - Docker –æ–±—Ä–∞–∑ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (FastAPI)
2. **Dockerfile.worker** - Docker –æ–±—Ä–∞–∑ –¥–ª—è –≤–æ—Ä–∫–µ—Ä–∞ —Å Whisper
3. **docker-compose.yml** - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
4. **.dockerignore** - –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è Docker —Å–±–æ—Ä–∫–∏
5. **requirements.admin.txt** - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∞–¥–º–∏–Ω–∫–∏
6. **requirements.worker.txt** - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–æ—Ä–∫–µ—Ä–∞ (–≤–∫–ª—é—á–∞—è Whisper!)

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (1 —Ñ–∞–π–ª)
7. **admin/main.py** - –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI

### –°–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (2 —Ñ–∞–π–ª–∞)
8. **scripts/get_user_pks.py** - –ü–æ–ª—É—á–µ–Ω–∏–µ user_pk –ø–æ usernames
9. **scripts/init_accounts.py** - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –≤ –ë–î

### –®–∞–±–ª–æ–Ω—ã –∞–¥–º–∏–Ω–∫–∏ (1 —Ñ–∞–π–ª)
10. **admin/templates/accounts/json_import.html** - UI –¥–ª—è JSON –∏–º–ø–æ—Ä—Ç–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (2 —Ñ–∞–π–ª–∞)
11. **.env.production.example** - –ü—Ä–∏–º–µ—Ä production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
12. **accounts_seed.json.example** - –ü—Ä–∏–º–µ—Ä JSON —Å –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (4 —Ñ–∞–π–ª–∞)
13. **DEPLOYMENT.md** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é (–∞–Ω–≥–ª.)
14. **ACCOUNT_INIT_GUIDE.md** - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (–∞–Ω–≥–ª.)
15. **DEPLOYMENT_CHECKLIST.md** - –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
16. **README_DEPLOY.md** - –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º

### –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (2 —Ñ–∞–π–ª–∞)
17. **src/services/instagram_service.py** - –¥–æ–±–∞–≤–ª–µ–Ω resolve_username_to_user_pk()
18. **admin/routes/accounts.py** - –¥–æ–±–∞–≤–ª–µ–Ω—ã JSON import endpoints

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (1 —Ñ–∞–π–ª)
19. **.gitignore** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å user_pk
- Account.id = Instagram user_pk (–ù–ï auto-increment)
- –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö user_pk
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ –ë–î –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### 2. Whisper –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω –≤ requirements.worker.txt
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ CPU-only PyTorch –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –≤—ã–±–æ—Ä—É –º–æ–¥–µ–ª–∏
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–æ–¥–µ–ª—å "base" (~140MB)

### 3. Docker –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è
- –û—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è admin –∏ worker
- –í–Ω–µ—à–Ω—è—è PostgreSQL
- Health checks –∏ –∞–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫

---

## üìã –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

### –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:
```bash
# 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
cat > usernames.txt << EOF
account1
account2
EOF

# 2. –ü–æ–ª—É—á–∏—Ç—å user_pk
python scripts/get_user_pks.py usernames.txt -o user_pks.json
```

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
git clone <repo> /opt/video_stats
cd /opt/video_stats
cp .env.example .env
nano .env

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å PostgreSQL
sudo -u postgres psql
CREATE DATABASE instagram_tracker;
CREATE USER tracker WITH PASSWORD 'password';
GRANT ALL PRIVILEGES ON DATABASE instagram_tracker TO tracker;
\q

# 3. –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
docker compose run --rm admin alembic upgrade head
docker compose run --rm admin python scripts/init_accounts.py user_pks.json

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ID (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –±–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞!)
docker compose exec admin psql ${DATABASE_URL} -c "SELECT id, username FROM accounts;"

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å
docker compose build
docker compose up -d
```

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã

### 1. User PK
**–û—à–∏–±–∫–∞:** –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç—ã —Å auto-increment ID (1, 2, 3...)
**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ:** –í–æ—Ä–∫–µ—Ä –Ω–µ —Å–º–æ–∂–µ—Ç —Å–∫–∞—á–∏–≤–∞—Ç—å –≤–∏–¥–µ–æ
**–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### 2. PostgreSQL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
**–û—à–∏–±–∫–∞:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `host.docker.internal` –≤ DATABASE_URL

### 3. –†–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª–Ω—ã–π PyTorch ~2GB
**–†–µ—à–µ–Ω–∏–µ:** –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å CPU-only torch –≤ requirements.worker.txt

---

## üìä –°—Ç–∞—Ç—É—Å

–í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã ‚úÖ

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä!
